{% extends "base.html" %}

{% block title %}Appointment Requests{% endblock %}

{% block content %}
<div class="bg-gradient-to-br from-[#dfe2ff] via-[#cbc1fa] to-[#a7c0f9] min-h-screen py-10">

  <div class="max-w-6xl mx-auto px-6">

    <!-- Header -->
    <div class="glass p-6 shadow mb-6">
      <h2 class="text-2xl font-bold text-violet-800">
        Appointment Requests
      </h2>
      <p class="text-indigo-600 text-sm">
        Approve or reject patient appointment requests
      </p>
    </div>

    <!-- Appointment List -->
    <div class="glass p-6 shadow">

      {% if appointments %}
      <table class="w-full border-collapse text-sm">
        <thead>
          <tr class="border-b text-left text-indigo-700">
            <th class="py-2">Patient</th>
            <th>Date</th>
            <th>Time</th>
            <th>Status</th>
            <th class="text-center">Action</th>
          </tr>
        </thead>

        <tbody>
          {% for a in appointments %}
          <tr class="border-b">
            <td class="py-2 font-semibold">
              {{ a.patient.username }}
            </td>

            <td>{{ a.slot.date }}</td>

            <td>
              {{ a.slot.start_time }} – {{ a.slot.end_time }}
            </td>

            <td>
              {% if a.status == "PENDING" %}
                <span class="text-yellow-600 font-semibold">Pending</span>
              {% elif a.status == "APPROVED" %}
                <span class="text-green-600 font-semibold">Approved</span>
              {% else %}
                <span class="text-red-600 font-semibold">Rejected</span>
              {% endif %}
            </td>

            <td class="text-center space-x-2">
              {% if a.status == "PENDING" %}
              <a
                href="{% url 'approve_appointment' a.id %}"
                class="inline-block px-4 py-1 bg-green-500 text-white rounded text-xs hover:bg-green-600"
              >
                Approve
              </a>

              <a
                href="{% url 'reject_appointment' a.id %}"
                class="inline-block px-4 py-1 bg-red-500 text-white rounded text-xs hover:bg-red-600"
              >
                Reject
              </a>
              {% else %}
              <span class="text-gray-400 text-xs">
                Action taken
              </span>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>

      {% else %}
      <p class="text-indigo-600 text-sm">
        No appointment requests found.
      </p>
      {% endif %}

    </div>

    <!-- Back -->
    <div class="mt-6">
      <a
        href="{% url 'doctor_dashboard' %}"
        class="text-violet-700 font-semibold underline hover:text-pink-600"
      >
        ← Back to Dashboard
      </a>
    </div>

  </div>
</div>
{% endblock %}
