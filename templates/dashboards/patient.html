{% extends "base.html" %}

{% block title %}
Doctor Dashboard
{% endblock %}

{% block content %}

<div
  class="bg-gradient-to-br from-[#dfe2ff] via-[#cbc1fa] to-[#a7c0f9] min-h-screen"
>
  <main class="max-w-6xl mx-auto px-6 pt-10 pb-20">
    <!-- Header -->
    <div class="mb-8">
      <h2 class="text-3xl font-extrabold text-violet-800">
        Welcome, {{ request.user.username }} ðŸ‘‹
      </h2>
      <p class="text-indigo-600">Your health summary</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
      <!-- Appointments -->
      <div class="glass p-8 shadow xl:col-span-2">
        <div class="flex justify-between items-center mb-4">
          <h3 class="font-bold text-indigo-800 text-lg">Appointments</h3>

          <!-- SAFE booking link -->
          <a
            href="{% url 'doctors_list' %}"
            class="px-4 py-2 rounded-full bg-gradient-to-r from-indigo-400 to-violet-500 text-white font-bold shadow hover:opacity-90"
          >
            Book New Appointment
          </a>
        </div>

        {% if appointments %}
        <table class="w-full text-sm">
          <tr class="border-b font-semibold text-left text-indigo-700">
            <th class="py-2">Doctor</th>
            <th>Date</th>
            <th>Time</th>
            <th>Status</th>
          </tr>

          {% for a in appointments %}
          <tr class="border-b">
            <td class="py-2">Dr. {{ a.slot.doctor.username }}</td>
            <td>{{ a.slot.date }}</td>
            <td>{{ a.slot.start_time }} - {{ a.slot.end_time }}</td>
            <td>
              {% if a.status == "PENDING" %}
                ðŸŸ¡ Pending Approval

              {% elif a.status == "APPROVED" %}
                ðŸŸ¢ Approved
                {% if a.consultation_status == "NOT_STARTED" %}
                  <div class="text-sm text-indigo-600">
                    Waiting for consultation
                  </div>
                {% endif %}

              {% elif a.status == "REJECTED" %}
                ðŸ”´ Rejected
              {% endif %}
            </td>

          </tr>
          {% endfor %}
        </table>
        {% else %}
        <p class="text-indigo-600">No appointments yet.</p>
        {% endif %}
      </div>

      <!-- Consultation -->
      <div class="glass p-8 shadow">
        <h3 class="font-bold text-indigo-800 mb-2">Consultation</h3>
        <p class="text-indigo-600">Video call will appear after approval</p>
      </div>

      <!-- Prescriptions -->
      <div class="glass p-8 shadow">
        <h3 class="font-bold text-indigo-800 mb-2">Prescriptions</h3>
        <p class="text-indigo-600">Prescription list will appear here</p>
      </div>

      <!-- Health Records -->
      <div class="glass p-8 shadow">
        <h3 class="font-bold text-indigo-800 mb-2">Health Records</h3>
        <p class="text-indigo-600">EHR view later</p>
      </div>

      <!-- Reminders -->
      <div class="glass p-8 shadow">
        <h3 class="font-bold text-indigo-800 mb-2">Reminders</h3>
        <p class="text-indigo-600">Medication reminders</p>
      </div>

      <!-- Profile -->
      <div class="glass p-8 shadow">
        <h3 class="font-bold text-indigo-800 mb-2">Profile</h3>
        <p class="text-indigo-600">{{ request.user.email }}</p>
      </div>
    </div>
  </main>
</div>
{% endblock %}
