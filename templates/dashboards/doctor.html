{% extends "base.html" %}

{% block title %}Doctor Dashboard{% endblock %}

{% block content %}
<div class="bg-gradient-to-br from-[#dfe2ff] via-[#cbc1fa] to-[#a7c0f9] min-h-screen py-10">

  <div class="max-w-7xl mx-auto px-6 grid grid-cols-1 lg:grid-cols-3 gap-10">

    <!-- LEFT COLUMN -->
    <div class="flex flex-col gap-7">

      <!-- Doctor Info -->
      <div class="glass p-6 shadow-lg flex items-center gap-5">
        <img
          src="https://randomuser.me/api/portraits/women/45.jpg"
          class="w-16 h-16 rounded-full border-2 border-violet-300"
        />
        <div>
          <h2 class="font-bold text-violet-800 text-2xl">
            Dr. {{ request.user.username }}
          </h2>
          <p class="text-indigo-600 text-sm">
            Manage your appointments & approvals
          </p>
        </div>
      </div>

      <!-- Slots -->
      <div class="glass p-6 shadow">
        <h3 class="font-bold text-violet-700 mb-2">Slots</h3>
        <p class="text-indigo-600 text-sm mb-2">Manage your availability</p>
        <a
          href="{% url 'doctor_slots' %}"
          class="text-violet-700 font-semibold underline hover:text-pink-600"
        >
          View / Edit Slots
        </a>
      </div>

      <!-- Profile -->
      <div class="glass p-6 shadow">
        <h3 class="font-bold text-violet-700 mb-2">Profile</h3>
        <p class="text-indigo-700 text-sm">
          <strong>Name:</strong> Dr. {{ request.user.username }} <br />
          <strong>Email:</strong> {{ request.user.email }}
        </p>
      </div>

    </div>

    <!-- RIGHT COLUMN -->
    <div class="col-span-2 flex flex-col gap-7">

      <!-- Appointment Requests -->
      <div class="glass p-7 shadow">
        <h2 class="text-xl font-bold text-indigo-800 mb-4">
          Appointment Requests
        </h2>

        {% if appointments %}
        <table class="w-full text-sm">
          <tr class="border-b font-semibold text-left">
            <th>Patient</th>
            <th>Date</th>
            <th>Time</th>
            <th>Action</th>
          </tr>

          {% for a in appointments %}
          <tr class="border-b">
            <td>{{ a.patient.username }}</td>
            <td>{{ a.slot.date }}</td>
            <td>{{ a.slot.start_time }} - {{ a.slot.end_time }}</td>
            <td class="flex gap-2 py-2">
              <a
                href="{% url 'approve_appointment' a.id %}"
                class="px-3 py-1 bg-green-500 text-white rounded text-xs"
              >
                Approve
              </a>
              <a
                href="{% url 'reject_appointment' a.id %}"
                class="px-3 py-1 bg-red-500 text-white rounded text-xs"
              >
                Reject
              </a>
            </td>
          </tr>
          {% endfor %}
        </table>
        {% else %}
        <p class="text-indigo-600 text-sm">No appointment requests yet.</p>
        {% endif %}
      </div>

      <!-- Notifications -->
      <div class="glass p-6 shadow">
        <h3 class="font-bold text-violet-700 mb-2">Notifications</h3>
        <p class="text-indigo-600 text-sm">
          Firebase notifications will appear here
        </p>
      </div>

    </div>

  </div>
</div>
{% endblock %}
